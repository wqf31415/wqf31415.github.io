<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>Raphael 事件处理</title>
</head>
<body>
<script src="raphael.min.js"></script>
<div>
    <figure class="highlight javascript"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> paper = Raphael(<span class="string">'view'</span>, <span class="number">350</span>, <span class="number">200</span>);</span><br><span class="line"><span class="keyword">let</span> rect = paper.rect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>, <span class="number">200</span>);</span><br><span class="line">rect.attr({<span class="attr">fill</span>: <span class="string">'white'</span>}); <span class="comment">// 设置图形填充，否则只能点击边框</span></span><br><span class="line"><span class="keyword">let</span> text = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">// 点击矩形显示点击位置坐标</span></span><br><span class="line">rect.click(<span class="function"><span class="keyword">function</span> (<span class="params">event, x, y</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Click event: '</span>, event, x, y);</span><br><span class="line">    <span class="keyword">if</span> (text != <span class="literal">null</span>) {</span><br><span class="line">        text.remove();</span><br><span class="line">    }</span><br><span class="line">    text = paper.text(<span class="number">325</span>, <span class="number">10</span>, <span class="string">"("</span> + event.layerX + <span class="string">","</span> + event.layerY + <span class="string">")"</span>);</span><br><span class="line">});</span><br><span class="line"><span class="comment">// 双击切换背景颜色，双击时会触发两次单击事件</span></span><br><span class="line">rect.dblclick(<span class="function"><span class="keyword">function</span> (<span class="params">event, x, y</span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (rect.attr(<span class="string">"fill"</span>) === <span class="string">'white'</span>) {</span><br><span class="line">        rect.attr({<span class="attr">fill</span>: <span class="string">'gray'</span>});</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        rect.attr({<span class="attr">fill</span>: <span class="string">'white'</span>});</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line"><span class="comment">// 绘制一个圆形，实现拖动效果</span></span><br><span class="line">circle = paper.circle(<span class="number">50</span>, <span class="number">50</span>, <span class="number">20</span>).attr({<span class="attr">fill</span>: <span class="string">'white'</span>});</span><br><span class="line">circle.drag(<span class="function"><span class="keyword">function</span> (<span class="params">dx, dy, x, y, event</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'On move: '</span>, dx, dy, x, y, event);</span><br><span class="line">    circle.attr(<span class="string">"cx"</span>, event.layerX);</span><br><span class="line">    circle.attr(<span class="string">"cy"</span>, event.layerY);</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">x, y, event</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Move start: '</span>, x, y, event)</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Move end: '</span>, event);</span><br><span class="line">});</span><br><span class="line"><span class="comment">// 给圆形添加hover处理函数，实现鼠标移入切换颜色</span></span><br><span class="line">circle.hover(<span class="function"><span class="keyword">function</span> (<span class="params">event, x, y</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hover in: '</span>, event, x, y);</span><br><span class="line">    circle.attr(<span class="string">'fill'</span>, <span class="string">'red'</span>);</span><br><span class="line">}, <span class="function"><span class="keyword">function</span> (<span class="params">event, x, y</span>) </span>{</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Hover out: '</span>, event, x, y);</span><br><span class="line">    circle.attr(<span class="string">'fill'</span>, <span class="string">'white'</span>);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></div></figure>
</div>
<div id="view"></div>
<script>
    let paper = Raphael('view', 350, 200);
    let rect = paper.rect(0, 0, 300, 200);
    rect.attr({fill: 'white'}); // 设置图形填充，否则只能点击边框
    let text = null;
    // 点击矩形显示点击位置坐标
    rect.click(function (event, x, y) {
        console.log('Click event: ', event, x, y);
        if (text != null) {
            text.remove();
        }
        text = paper.text(325, 10, "(" + event.layerX + "," + event.layerY + ")");
    });
    // 双击切换背景颜色，双击时会触发两次单击事件
    rect.dblclick(function (event, x, y) {
        if (rect.attr("fill") === 'white') {
            rect.attr({fill: 'gray'});
        } else {
            rect.attr({fill: 'white'});
        }
    });
    // 绘制一个圆形，实现拖动效果
    circle = paper.circle(50, 50, 20).attr({fill: 'white'});
    circle.drag(function (dx, dy, x, y, event) {
        console.log('On move: ', dx, dy, x, y, event);
        circle.attr("cx", event.layerX);
        circle.attr("cy", event.layerY);
    }, function (x, y, event) {
        console.log('Move start: ', x, y, event)
    }, function (event) {
        console.log('Move end: ', event);
    });
    // 给圆形添加hover处理函数，实现鼠标移入切换颜色
    circle.hover(function (event, x, y) {
        console.log('Hover in: ', event, x, y);
        circle.attr('fill', 'red');
    }, function (event, x, y) {
        console.log('Hover out: ', event, x, y);
        circle.attr('fill', 'white');
    });
</script>
</body>
</html>